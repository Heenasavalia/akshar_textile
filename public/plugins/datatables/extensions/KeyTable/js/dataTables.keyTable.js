var KeyTable;!function(B,P){function e(w,e){"use strict";return(KeyTable=function(e){this.block=!1,this.event={remove:{}},this.fnGetCurrentPosition=function(){return[b,v]},this.fnGetCurrentData=function(){return y.innerHTML},this.fnGetCurrentTD=function(){return y},this.fnSetPosition=function(e,t){"object"==typeof e&&e.nodeName?D(e):D(_(e,t))},this.fnBlur=function(){N()};var i,f,t,n,s=null,y=null,b=null,v=null,u=null,T="focus",h=!1,c={action:[],esc:[],focus:[],blur:[]},m=null,d=!1;function o(a){return function(e,t,n){if(null!==e&&"number"!=typeof e||null!==t&&"number"!=typeof t||"function"!=typeof n)if("object"==typeof e&&"function"==typeof t){var o=C(e);r(a,o[0],o[1],t)}else alert("Unhandable event type was added: x"+e+"  y:"+t+"  z:"+n);else r(a,e,t,n)}}function a(a){return function(e,t,n){if(null!==e&&"number"!=typeof e||null!==t&&"number"!=typeof t)if("object"==typeof e){var o=C(e);"function"==typeof t?p(a,o[0],o[1],t):p(a,o[0],o[1])}else alert("Unhandable event type was removed: x"+e+"  y:"+t+"  z:"+n);else"function"==typeof n?p(a,e,t,n):p(a,e,t)}}for(var l in c)l&&(this.event[l]=o(l),this.event.remove[l]=a(l));function r(e,t,n,o){c[e].push({x:t,y:n,fn:o})}function p(e,t,n,o){for(var a=0,l=0,r=c[e].length;l<r-a;l++)if(void 0!==o)c[e][l-a].x==t&&c[e][l-a].y==n&&c[e][l-a].fn==o&&(c[e].splice(l-a,1),a++);else if(c[e][l-a].x==t&&c[e][l-a].y==n)return c[e].splice(l,1),1;return a}function g(e,t,n){for(var o=0,a=c[e],l=0;l<a.length;l++)(a[l].x==t&&a[l].y==n||null===a[l].x&&a[l].y==n||a[l].x==t&&null===a[l].y||null===a[l].x&&null===a[l].y)&&(a[l].fn(_(t,n),t,n),o++);return o}function D(e,t){if(y!=e){var n;if(void 0===t&&(t=!0),null!==y&&S(y),w(e).addClass(T),w(e).parent().addClass(T),m){n=m;for(var o=j(e)[1],a=h;o>=n.fnDisplayEnd();)0<=n._iDisplayLength?n._iDisplayStart+n._iDisplayLength<n.fnRecordsDisplay()&&(n._iDisplayStart+=n._iDisplayLength):n._iDisplayStart=0,m.oApi._fnCalculateEnd(n);for(;o<n._iDisplayStart;)n._iDisplayStart=0<=n._iDisplayLength?n._iDisplayStart-n._iDisplayLength:0,n._iDisplayStart<0&&(n._iDisplayStart=0),m.oApi._fnCalculateEnd(n);m.oApi._fnDraw(n),h=a}var l,r,i,f,s,u,c,d=C(e);if(y=e,b=d[0],v=d[1],t&&(l=w(B).height(),r=w(B).width(),i=w(P).scrollTop(),f=w(P).scrollLeft(),s=e.offsetHeight,u=e.offsetWidth,c=function(e){var t=0,n=0;if(e.offsetParent)for(t=e.offsetLeft,n=e.offsetTop,e=e.offsetParent;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return[t,n]}(e),!m||void 0===n.oScroll||""===n.oScroll.sX&&""===n.oScroll.sY||(c[1]-=w(n.nTable.parentNode).scrollTop(),c[0]-=w(n.nTable.parentNode).scrollLeft()),c[1]+s>i+l?E(c[1]+s-l):c[1]<i&&E(c[1]),c[0]+u>f+r?K(c[0]+u-r):c[0]<f&&K(c[0])),m&&void 0!==n.oScroll&&(""!==n.oScroll.sX||""!==n.oScroll.sY)){var p=n.nTable.parentNode;l=p.clientHeight,r=p.clientWidth,i=p.scrollTop,f=p.scrollLeft,s=e.offsetHeight,u=e.offsetWidth,e.offsetTop+s>l+i?p.scrollTop=e.offsetTop+s-l:e.offsetTop<i&&(p.scrollTop=e.offsetTop),e.offsetLeft+u>r+f?p.scrollLeft=e.offsetLeft+u-r:e.offsetLeft<f&&(p.scrollLeft=e.offsetLeft)}k(),g("focus",b,v)}}function N(){S(y),y=v=b=null,h=!1}function S(e){w(e).removeClass(T),w(e).parent().removeClass(T),g("blur",b,v)}function x(e){for(var t=this;"TD"!=t.nodeName;)t=t.parentNode;D(t),k()}function L(e){if(u.block||!h)return!0;if(e.metaKey||e.altKey||e.ctrlKey)return!0;var t,n,o,a=s.getElementsByTagName("tr")[0].getElementsByTagName("td").length;if(m){o=m.aiDisplay.length;var l=j(y);if(null===l)return;b=l[0],v=l[1]}else o=s.getElementsByTagName("tr").length;var r=9==e.keyCode&&e.shiftKey?-1:e.keyCode;switch(r){case 13:return e.preventDefault(),e.stopPropagation(),g("action",b,v),!0;case 27:if(!g("esc",b,v))return void N();t=b,n=v;break;case-1:case 37:if(0<b)t=b-1,n=v;else{if(!(0<v))return!(-1!=r||!i)&&(d=!0,f.focus(),setTimeout(function(){d=!1},0),h=!1,N(),!0);t=a-1,n=v-1}break;case 38:if(!(0<v))return!1;t=b,n=v-1;break;case 36:t=b,n=0;break;case 33:t=b,(n=v-10)<0&&(n=0);break;case 9:case 39:if(b<a-1)t=b+1,n=v;else{if(!(v<o-1))return!(9!=r||!i)&&(d=!0,f.focus(),setTimeout(function(){d=!1},0),h=!1,N(),!0);t=0,n=v+1}break;case 40:if(!(v<o-1))return!1;t=b,n=v+1;break;case 35:t=b,n=o-1;break;case 34:t=b,o-1<(n=v+10)&&(n=o-1);break;default:return!0}return D(_(t,n)),!1}function k(){h=h||!0}function _(e,t){return m?void 0!==m.aoData[m.aiDisplay[t]]?m.aoData[m.aiDisplay[t]].nTr.getElementsByTagName("td")[e]:null:w("tr:eq("+t+")>td:eq("+e+")",s)[0]}function C(e){return m?[w("td",e.parentNode).index(e),w("tr",e.parentNode.parentNode).index(e.parentNode)+m._iDisplayStart]:[w("td",e.parentNode).index(e),w("tr",e.parentNode.parentNode).index(e.parentNode)]}function E(e){P.documentElement.scrollTop=e,P.body.scrollTop=e}function K(e){P.documentElement.scrollLeft=e,P.body.scrollLeft=e}function j(e){for(var t=0,n=m.aiDisplay.length;t<n;t++)for(var o=m.aoData[m.aiDisplay[t]].nTr.getElementsByTagName("td"),a=0,l=o.length;a<l;a++)if(o[a]==e)return[a,t];return null}void 0===e?(t=w("table.KeyTable")[0],n=null):w.isPlainObject(e)?(t=e.table,n=e.datatable):t=(n=new w.fn.dataTable.Api(e).settings()[0]).nTable,function(e,t,o,n){if(u=n,void 0===o&&(o={}),void 0===o.focus&&(o.focus=[0,0]),o.table=e,w(o.table).addClass("KeyTable"),void 0!==o.focusClass&&(T=o.focusClass),void 0!==t&&(m=t),void 0===o.initScroll&&(o.initScroll=!0),void 0===o.form&&(o.form=!1),i=o.form,s=o.table.getElementsByTagName("tbody")[0],i){var a=P.createElement("div");f=P.createElement("input"),a.style.height="1px",a.style.width="0px",a.style.overflow="hidden",void 0!==o.tabIndex&&(f.tabIndex=o.tabIndex),a.appendChild(f),o.table.parentNode.insertBefore(a,o.table.nextSibling),w(f).focus(function(){d||(d=!(h=!0),void 0!==o.focus.nodeName?D(o.focus,o.initScroll):D(_(o.focus[0],o.focus[1]),o.initScroll),setTimeout(function(){f.blur()},0))}),h=!1}else void 0!==o.focus.nodeName?D(o.focus,o.initScroll):D(_(o.focus[0],o.focus[1]),o.initScroll),k();w(P).bind("keydown",L),m?w(m.nTable).on("click","td",x):w(s).on("click","td",x),w(P).click(function(e){for(var t=e.target,n=!1;t;){if(t==o.table){n=!0;break}t=t.parentNode}n||N()})}(t,n,e,this)}).version="1.2.1",w.fn.dataTable.KeyTable=KeyTable,w.fn.DataTable.KeyTable=KeyTable}"function"==typeof define&&define.amd?define(["jquery","datatables"],e):"object"==typeof exports?e(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.KeyTable&&e(jQuery,jQuery.fn.dataTable)}(window,document);